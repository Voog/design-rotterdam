"use strict";!function(e){var t=function(t){this.$el=e(t),this.init()};t.prototype={init:function(){e(".form_field").each(e.proxy(function(t,o){e(o).find('input[type="text"]').length>0&&(e(o).find('input[type="text"]').attr("placeholder",e(o).find("label").text()),e(o).find("label").hide(),e.fn.placeholder&&e(o).find('input[type="text"]').placeholder()),e(o).find("textarea").length>0&&(e(o).find("textarea").attr("placeholder",e(o).find("label").text()),e(o).find("label").hide(),e.fn.placeholder&&e(o).find("textarea").placeholder())},this))}},e.fn.edicyFormPlaceholders=function(){return this.each(function(){e(this).data("edicyFormPlaceholders")||e(this).data("edicyFormPlaceholders",new t(this))})}}(jQuery),function(e){var t=function(t,o,a){if(t){new VoogSearch(t,{per_page:10,lang:o,resultsContainer:e(".js-voog-search-modal-inner").get(0),sideclick:!0,mobileModeWidth:640,updateOnKeypress:!0,noResults:a})}},o=e("html").hasClass("editmode"),a=function(){e(".js-option-toggle-flags").on("click",function(t){if(t.stopPropagation(),e(this).hasClass("js-flag-disable-btn"))var o=!1;else var o=!0;e(this).toggleClass("js-flag-disable-btn"),e("body").toggleClass("flags-enabled flags-disabled"),siteData.set("flags_state",o)})},i=function(){var t=e(".js-header-inner").width(),o=e(".js-header-right"),a=o.width(),i=parseInt(o.css("margin-left"))+1;e(".js-header-left").css("min-width",t-a-i)},s=function(){o||e.each(e(".content-formatted table"),function(){e(this).wrap('<div class="table-container"></div>')})},n=function(){e(".js-menu-toggle").click(function(){e(this).toggleClass("open"),e(".mobile-menu").toggleClass("expanded"),e(this).hasClass("open")?e(".js-search").addClass("hidden"):e(".js-search").removeClass("hidden")})},r=function(){e("#lang-menu-toggle").click(function(t){t.stopPropagation(),e(this).toggleClass("open"),e("#toggleable-lang-menu").toggleClass("expanded")}),e("body").on("click",function(t){var o=e(t.target);0!==o.closest(".toggleable-lang-menu").length||o.is("#toggleable-lang-menu")||(e("#toggleable-lang-menu").removeClass("expanded"),e("body").removeClass("voog-search-visible")),e("#lang-menu-toggle").removeClass("open")})},d=function(){e("html").click(function(t){var o=e(t.target);0===o.closest(".mobile-menu").length&&0===o.closest(".toggle-btn").length&&e(".mobile-menu").hasClass("expanded")&&(e(".mobile-menu").removeClass("expanded"),e(".js-menu-toggle").removeClass("open"),e(".js-menu-toggle").hasClass("open")||e(".js-search").removeClass("hidden"))})},l=function(){e(".js-search-reset").click(function(t){t.preventDefault(),e("body").removeClass("voog-search-visible")}),e(".js-search-open").click(function(t){t.stopPropagation(),e("body").addClass("voog-search-visible"),e(".js-search-input").val("").focus()}),e(".js-search-close").click(function(t){e("body").removeClass("voog-search-visible")}),e(".js-search-input").click(function(e){e.stopPropagation()}),e(".js-voog-search-modal-inner").click(function(e){e.stopPropagation()})},c=function(e,t){for(var o,a=0,i=e.length;a<i;a++){if(e[a].width<t)return o||e[a];o=e[a]}return e[e.length-1]},g=function(e,t){for(var o=e.length;o--;)if(t.indexOf(e[o].url.trim())>-1)return!0;return!1},h=function(){headerBgCombinedLightness>=.5?e(".js-background-type").addClass("light-background").removeClass("dark-background"):e(".js-background-type").addClass("dark-background").removeClass("light-background")},m=function(t,o){var a=e(".js-header-banner").css("background-image"),i=t.imageSizes?c(t.imageSizes,e(window).width()):null,s=t.image&&""!==t.image?"url("+i.url+")":"none",n=t.imageSizes&&""!==t.imageSizes?t.imageSizes:null,r=t.color&&""!==t.color?t.color:"rgba(0,0,0,0)",d=(t.colorData&&""!==t.colorData&&t.colorData.lightness,e("<img>")),l=e("<canvas>"),m=t.image&&""!==t.image?t.image:null;m?g(n,a)?(headerBg.headerBgImageColor=headerBg.headerBgImageColor?headerBg.headerBgImageColor:"rgba(178,198,207,1)",headerBgCombinedLightness=C(headerBg.headerBgImageColor,r),h()):(d.attr("src",m.replace(/.*\/(photos|voogstock)/g,"/photos")),d.on("load",function(){ColorExtract.extract(d[0],l[0],function(e){headerBg.headerBgImageColor=e.bgColor?e.bgColor:"rgba(255,255,255,1)",headerBgCombinedLightness=C(headerBg.headerBgImageColor,r),h()})})):(headerBg.headerBgImageColor="rgba(255,255,255,1)",headerBgCombinedLightness=C(headerBg.headerBgImageColor,r),h()),e(o).css({"background-image":s}),e(o).find(".background-color").css({"background-color":r})},f=function(t,o){var a=e.extend(!0,{},t);a.image=t.image||"",a.imageSizes=t.imageSizes||"",a.color=t.color||"rgba(255,255,255,0)",a.combinedLightness=headerBgCombinedLightness,pageData.set(o,a)},u=function(t,o){if(t&&o){"string"==typeof t&&(t=t.replace(/rgba?\(/,"").replace(/\)/,"").split(","),e.each(t,function(e,o){t[e]=+o})),"string"==typeof o&&(o=o.replace(/rgba?\(/,"").replace(/\)/,"").split(","),e.each(o,function(e,t){o[e]=+t})),"object"==typeof t&&t.hasOwnProperty("length")&&3==t.length&&t.push(1),"object"==typeof o&&o.hasOwnProperty("length")&&3==o.length&&o.push(1);var a=[0,0,0,0];return a[3]=1-(1-o[3])*(1-t[3]),0===a[3]&&(a[3]=1e-6),a[0]=Math.min(o[0]*o[3]/a[3]+t[0]*t[3]*(1-o[3])/a[3],255),a[1]=Math.min(o[1]*o[3]/a[3]+t[1]*t[3]*(1-o[3])/a[3],255),a[2]=Math.min(o[2]*o[3]/a[3]+t[2]*t[3]*(1-o[3])/a[3],255),e.map(a,function(e){return Math.floor(e)})}},p=function(e,t){return u(e||[255,255,255,1],t||[255,255,255,1])},C=function(e,t){var o=p(e,t);return Math.round((.2126*+o[0]+.7152*+o[1]+.0722*+o[2])/2.55)/100},v=function(t){void 0!==t&&(t>.6?e(".header-wrapper").addClass("light").removeClass("dark"):e(".header-wrapper").addClass("dark").removeClass("light"))},b=function(){e(window).ready(function(){e(".post").each(function(t,o){var a=e(o),i=a.find(".post-header").height();a.find(".post-content").css("min-height",i)})})},y=function(){e(document).ready(function(){e(".comment-form").hasClass("form_with_errors")?e("html, body").scrollTop(e(".comment-form").offset().top):e("form").find(".form_error, .form_notice").length>0&&e("html, body").scrollTop(e(".form_error, .form_notice").closest("form").offset().top)})},w=function(e){(e=void 0!==e&&e)&&j({stickyHeader:!0,stickyMobileMenu:!0,stickyFooter:!1,stickyPostHeaders:!1})},x=function(t){t=void 0!==t&&t,t&&j({stickyHeader:!0,stickyMobileMenu:!0,stickyFooter:!1,stickyPostHeaders:!1}),e.fn.autogrow&&e(".form_field_textarea").autogrow(),e(window).ready(function(){e.trim(e(".content-header").get(0).innerHTML)||e(".content-header").hide()})},k=function(t){t=void 0!==t&&t,t&&j({stickyHeader:!0,stickyMobileMenu:!0,stickyFooter:!1,stickyPostHeaders:!1}),e.fn.autogrow&&e(".form_field_textarea").autogrow()},_=function(e){e=void 0!==e&&e,e&&j({stickyHeader:!0,stickyMobileMenu:!0,stickyFooter:!0,stickyPostHeaders:!0}),b()},j=function(t){var o,a,i,s,n=t.stickyHeader||!1,r=t.stickyMobileMenu||!1,d=t.stickyFooter||!1,l=t.stickyPostHeaders||!1,c=e(".container"),g=e(".header"),h=e(".footer"),m=e(g).height()+90,f=e(h).height()+90,u=0,p=!1,C=function(){var t=e(".post"),o=[];return t.each(function(e,t){o.push(t.getBoundingClientRect().top)}),o},v=function(t){o?(a=e(window).scrollTop(),i=a-o,window.innerWidth<640&&r&&(i>5&&o>m?e(".topbar").addClass("fixed").css({top:-m}):i<-5&&o>m?e(".topbar").addClass("fixed").css({top:0}):i<0&&o<=100&&!0===e(".topbar").hasClass("fixed")&&(e(c).css({"margin-top":0}),e(".topbar").removeClass("fixed"))),window.innerWidth>640&&d&&(e(".post").eq(0).offset().top-e(window).innerHeight()+90<e(document).scrollTop()&&o+window.innerHeight<=e(document).height()-f-40?i<-5?_(!1):i>5&&x():k()),n&&e(g).find(".header-inner").height()<60&&(i>5&&o>m?b():i<-5&&o>m?(y(),setTimeout(function(){e(window).scrollTop()<=m&&w()},20)):i<-5&&o<=m&&w()),o=0):o=e(window).scrollTop(),window.innerWidth>640&&l&&e(".post").each(function(o,a){var i=e(a).find(".post-header"),s=-(e(a).height()-30-i.height());t[o]<30?t[o]>s?(i.removeClass("top bottom"),e(a).addClass("fixed-header")):(i.addClass("bottom").removeClass("top"),e(a).removeClass("fixed-header")):(i.addClass("top").removeClass("bottom"),e(a).removeClass("fixed-header"))})},b=function(){e(g).addClass("header-fixed").css({top:-m}),e(c).css({"padding-top":m})},y=function(){var t;t=e("body").hasClass("edy-checkout-button-visible")?e(".edy-ecommerce-shopping-cart-button").outerHeight():0,e(g).addClass("header-fixed header-animated").css({top:t}),e(c).css({"padding-top":m})},w=function(){e(g).removeClass("header-fixed header-animated"),e(c).css({"padding-top":0}),e(".post.fixed-header").removeClass("fixed-header")},x=function(){e(h).addClass("footer-fixed footer-animated footer-hidden"),e(h).css("bottom",-e(h).outerHeight())},k=function(){e(h).removeClass("footer-fixed footer-animated footer-hidden"),e("body").removeClass("voog-search-visible"),e(h).css({bottom:"",left:""}),e(c).css({"margin-bottom":""})},_=function(t){t=t||!1,e(h).addClass("footer-fixed footer-animated"),e(h).css({left:e(".container").offset().left,bottom:t?0:60-e(h).height()}),e(c).css({"margin-bottom":f})},j=function(t){t?e(h).hasClass("footer-fixed")&&(clearTimeout(s),_(!0),e("footer .gradient-overlay").hide()):e("footer").hasClass("footer-fixed")&&(s=setTimeout(function(){_(!1),e("footer .gradient-overlay").show()},1500))},B=function(){u=window.scrollY,A()},A=function(){p||requestAnimationFrame(P),p=!0},P=function(){p=!1,e(window).width()>640&&v(C())};e(window).on("load resize",function(){e(window).width()>640?v(C()):(e(".container").css({"padding-top":"","margin-bottom":""}),e(".header-fixed").removeClass("header-fixed header-animated").css("top",""))}).on("scroll",B),e("footer").bind("mouseenter",function(){j(!0)}).bind("mouseleave",function(){j(!1)})},B=function(e){window.edy=window.edy||[],edy.push(["texteditorStyles",{name:e,tagname:"a",attribute:{href:"#"},classname:"custom-btn",toggle:!0}])},A=function(){o()||S()},P=function(t){"show_product_related_pages_in_main_menu"in t||(t.show_product_related_pages_in_main_menu=!1),e(".js-root-item-settings-toggle").each(function(o,a){new Edicy.SettingsEditor(a,{menuItems:[{titleI18n:"show_in_main_menu",type:"checkbox",key:"show_product_related_pages_in_main_menu",states:{on:!0,off:!1}}],buttonTitleI18n:"settings",values:t,containerClass:["js-root-item-settings-popover","js-prevent-sideclick"],preview:function(t){!0==!t.show_product_related_pages_in_main_menu?e(".js-menu-item-products").addClass("is-hidden"):e(".js-menu-item-products").removeClass("is-hidden")},commit:function(e){siteData.set("settings_root_item",e)}})})},I=function(t){e(".js-content-item-img-drop-area").each(function(o,a){var i=e(a),s=i.closest(".js-content-item-box"),n=s.data("item-id"),r=s.data("item-type");new Edicy.CustomData({type:r,id:n}),new Edicy.ImgDropArea(i,{positionable:!1,target_width:1280,placeholder:'<div class="edy-img-drop-area-placeholder">'+t+"</div>",removeBtn:'<div class="edy-img-drop-area-remove-image"><div class="edy-img-drop-area-remove-image-ico"><svg width="16" height="20" viewBox="0 0 26 30" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="currentColor"><g transform="translate(2 5)"><path d="M0 .997h2V21c0 1 1 2 2 2h14c1 0 2-1 2-2V1h2v20c0 2.25-1.75 4-4 4H4c-2.25 0-4-1.75-4-4V.997z"/><rect x="10" y="4" width="2" height="16" rx="1"/><rect x="5" y="4" width="2" height="16" rx="1"/><rect x="15" y="4" width="2" height="16" rx="1"/></g><path d="M26 4v2H0V4h7V2c0-1 1-2 2-2h8c1 0 2 1 2 2v2h7zM9 4h8V3c0-.5-.5-1-1-1h-6c-.5 0-1 .5-1 1v1z"/></g></svg></div></div>',change:function(e){var t;i.removeClass("is-cropped").addClass("not-cropped").css("opacity",.1),e?(t=e.original_id,s.removeClass("without-image is-loaded with-error").addClass("with-image not-loaded"),M(s,e.width,e.height)):(t=null,s.removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),s.find(".edy-img-drop-area-placeholder").css("opacity",0)),H(s,i,n,t,r)}})})},M=function(e,t,o){var a=e.find(".js-content-item-img-drop-area"),i=e.find(".js-toggle-crop-state");t>o?a.removeClass("image-landscape image-square image-portrait").addClass("image-landscape"):t===o?a.removeClass("image-landscape image-square image-portrait").addClass("image-square"):a.removeClass("image-landscape image-square image-portrait").addClass("image-portrait"),a.hasClass("image-square")?i.removeClass("is-visible").addClass("is-hidden"):i.removeClass("is-hidden").addClass("is-visible")},H=function(t,o,a,i,s){var n="article"===s?"articles":"pages",r=new Edicy.CustomData({type:s,id:a});e.ajax({type:"PATCH",contentType:"application/json",url:"/admin/api/"+n+"/"+a,data:JSON.stringify({image_id:i}),dataType:"json",success:function(e){r.set("image_crop_state","not-cropped"),t.removeClass("not-loaded with-error").addClass("is-loaded"),t.find(".edy-img-drop-area-placeholder").css("opacity",1),o.css("opacity",1)},timeout:3e4,error:function(e){t.removeClass("not-loaded is-loaded with-error").addClass("with-error")}})},T=function(){e(".js-toggle-crop-state").on("click",function(){var t,o=e(this).closest(".js-content-item-box"),a=o.find(".js-content-item-img-drop-area"),i=o.data("item-id"),s=o.data("item-type"),n=new Edicy.CustomData({type:s,id:i});a.hasClass("is-cropped")?(a.removeClass("is-cropped").addClass("not-cropped"),t="not-cropped"):(a.removeClass("not-cropped").addClass("is-cropped"),t="is-cropped"),n.set("image_crop_state",t)})},S=function(){e(document).ready(function(){setTimeout(function(){e(".js-content-item-box").addClass("not-loaded")},3e3)}),e(".js-lazyload").lazyload({threshold:500,effect:"fadeIn",placeholder:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",load:function(){var t=e(this).closest(".js-content-item-box");t.removeClass("not-loaded with-error").addClass("is-loaded"),setTimeout(function(){t.removeClass("not-loaded with-error"),t.find(".js-loader").remove()},3e3)}})},o=function(){return e("html").hasClass("editmode")};window.site=e.extend(window.site||{},{initFrontPage:w,initCommonPage:x,initBlogPage:_,initArticlePage:k,toggleFlags:a,getImageByWidth:c,headerBgPreview:m,headerBgCommit:f,initItemsPage:A,handleHeaderColorScheme:v,bindCustomTexteditorStyles:B,bindRootItemSettings:P,bindContentItemImgDropAreas:I,bindContentItemImageCropToggle:T,bindSiteSearch:t}),function(){n(),r(),d(),l(),s(),y(),e(".content form").edicyFormPlaceholders(),!Modernizr.flexbox&&o&&i()}()}(jQuery);